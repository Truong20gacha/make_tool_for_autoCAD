# Generated block drawing as Python module (keep layer color & real block name)
BLOCK_NAME = r"xa_X2KD_3NK"
LAYERS = {
    "BAO": {"color": 3},
    "0": {"color": 7},
    "Tim": {"color": 6},
    "tex": {"color": 4},
    "B": {"color": 1},
}

def _get_doc(layout):
    return getattr(layout, 'doc', None) or getattr(layout, 'drawing', None)

def _ensure_layers(doc):
    for name, attrs in LAYERS.items():
        if name in doc.layers:
            lay = doc.layers.get(name)
            if 'color' in attrs:
                lay.color = attrs['color']
        else:
            doc.layers.new(name, dxfattribs={'color': attrs.get('color', 7)})

def _draw_into(layout):
    layout.add_line((-1245.690742, -49.275359), (1254.309258, -49.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((-1245.690742, 16.20466), (1254.309258, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-1245.690742, -11.775359), (1254.309258, -11.775359), dxfattribs={ "layer": "0", "color": 8 })
    layout.add_line((-145.426999, -483.215415), (-145.426999, -540.335302), dxfattribs={ "layer": "Tim", "color": 8 })
    layout.add_line((-213.426865, -511.775359), (222.045382, -511.775359), dxfattribs={ "layer": "0", "color": 8 })
    layout.add_line((-213.426865, -480.275359), (-213.426865, -543.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((-213.426865, -480.275359), (222.045382, -480.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((-42.397725, -543.275359), (-42.397725, -480.275359), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-111.637484, -543.275359), (-111.637484, -480.275359), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-77.017605, -543.275359), (-77.017605, -480.275359), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-1245.690742, 25.724641), (-1245.690742, -49.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((-217.125355, -485.000334), (-845.690742, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-232.84394, -505.081487), (-889.748115, 16.20466), dxfattribs={ "layer": "0", "color": 8 })
    layout.add_line((-252.261015, -529.887615), (-213.426865, -543.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((-213.426865, -480.275359), (-252.261015, -529.887615), dxfattribs={ "layer": "BAO" })
    layout.add_line((-649.008819, 124.386265), (-649.008819, 27.022821), dxfattribs={ "layer": "BAO" })
    layout.add_line((-649.008819, 27.022821), (-551.645374, 27.022821), dxfattribs={ "layer": "BAO" })
    layout.add_line((-551.645374, 27.022821), (-551.645374, 36.29553), dxfattribs={ "layer": "BAO" })
    layout.add_line((-551.645374, 36.29553), (-639.73611, 36.29553), dxfattribs={ "layer": "BAO" })
    layout.add_line((-639.73611, 36.29553), (-639.73611, 124.386265), dxfattribs={ "layer": "BAO" })
    layout.add_line((-639.73611, 124.386265), (-649.008819, 124.386265), dxfattribs={ "layer": "BAO" })
    # ko hỗ trợ hatch ( empty )
    layout.add_line((-595.690742, 50.990632), (-595.690742, 4.627087), dxfattribs={ "layer": "0", "color": 8 })
    # ko hỗ trợ hatch ( empty )
    layout.add_line((-595.690742, 36.29553), (-595.690742, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((-213.426865, -480.275359), (-836.088986, 16.20466), dxfattribs={ "layer": "BAO" })
    layout.add_line((-213.426865, -486.275359), (222.045382, -486.275359), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-252.261015, -529.887615), (-936.907444, 16.20466), dxfattribs={ "layer": "BAO" })
    layout.add_line((-213.426865, -543.275359), (222.045382, -543.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((222.045382, -480.275359), (222.045382, -543.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((225.743871, -485.000334), (854.309258, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((241.462457, -505.081487), (898.366631, 16.20466), dxfattribs={ "layer": "0", "color": 8 })
    layout.add_line((260.879531, -529.887615), (222.045382, -543.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((222.045382, -480.275359), (260.879531, -529.887615), dxfattribs={ "layer": "BAO" })
    layout.add_line((222.045382, -480.275359), (844.707502, 16.20466), dxfattribs={ "layer": "BAO" })
    layout.add_line((260.879531, -529.887615), (945.52596, 16.20466), dxfattribs={ "layer": "BAO" })
    layout.add_line((1254.309258, 25.724641), (1254.309258, -49.275359), dxfattribs={ "layer": "BAO" })
    layout.add_line((657.627335, 124.386265), (657.627335, 27.022821), dxfattribs={ "layer": "BAO" })
    layout.add_line((657.627335, 27.022821), (560.26389, 27.022821), dxfattribs={ "layer": "BAO" })
    layout.add_line((560.26389, 27.022821), (560.26389, 36.29553), dxfattribs={ "layer": "BAO" })
    layout.add_line((560.26389, 36.29553), (648.354626, 36.29553), dxfattribs={ "layer": "BAO" })
    layout.add_line((648.354626, 36.29553), (648.354626, 124.386265), dxfattribs={ "layer": "BAO" })
    layout.add_line((648.354626, 124.386265), (657.627335, 124.386265), dxfattribs={ "layer": "BAO" })
    # ko hỗ trợ hatch ( empty )
    layout.add_line((604.309258, 50.990632), (604.309258, 4.627087), dxfattribs={ "layer": "0", "color": 8 })
    # ko hỗ trợ hatch ( empty )
    layout.add_line((604.309258, 36.29553), (604.309258, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((154.045516, -483.215415), (154.045516, -540.335302), dxfattribs={ "layer": "Tim", "color": 8 })
    layout.add_line((51.016241, -543.275359), (51.016241, -480.275359), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((120.256, -543.275359), (120.256, -480.275359), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((85.636121, -543.275359), (85.636121, -480.275359), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-145.426999, 16.20466), (-145.426999, -40.335302), dxfattribs={ "layer": "Tim", "color": 8 })
    layout.add_line((-42.397725, -49.275359), (-42.397725, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-111.637484, -49.275359), (-111.637484, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((-77.017605, -49.275359), (-77.017605, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((154.045516, 16.784585), (154.045516, -40.335302), dxfattribs={ "layer": "Tim", "color": 8 })
    layout.add_line((51.016241, -49.275359), (51.016241, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((120.256, -49.275359), (120.256, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_line((85.636121, -49.275359), (85.636121, 16.20466), dxfattribs={ "layer": "BAO", "color": 8 })
    layout.add_circle((-1065.198232, 39.324615), 42.37567093204112, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-1065.198232, 39.324615), 79.71615000000742, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-1065.198232, 39.324615), 112.4185817171906, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-1290.035396, 39.324615), 42.37567093204112, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-1290.035396, 39.324615), 79.71615000000742, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-1290.035396, 39.324615), 112.4185817171906, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((116.801902, 39.324615), 42.37567093204112, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((116.801902, 39.324615), 79.71615000000742, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((116.801902, 39.324615), 112.4185817171906, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-108.035262, 39.324615), 42.37567093204112, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-108.035262, 39.324615), 79.71615000000742, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((-108.035262, 39.324615), 112.4185817171906, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((1298.802036, 39.324615), 42.37567093204112, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((1298.802036, 39.324615), 79.71615000000742, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((1298.802036, 39.324615), 112.4185817171906, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((1073.964872, 39.324615), 42.37567093204112, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((1073.964872, 39.324615), 79.71615000000742, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_circle((1073.964872, 39.324615), 112.4185817171906, dxfattribs={ "layer": "0", "color": 2 })
    layout.add_line((1254.309258, 25.724641), (-1245.690742, 25.724641), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-157.666975, -511.775359), 14.95997051993618, 180.0000000002084, 270.0000000002084, dxfattribs={ "layer": "BAO" })
    layout.add_line((-172.626946, -511.775359), (-172.626946, -511.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-157.666975, -511.775359), 14.95997052016901, 90.00000000062533, 180.0000000006253, dxfattribs={ "layer": "BAO" })
    layout.add_line((-157.666975, -496.815388), (-133.187024, -496.815388), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-133.187024, -511.775359), 14.95997052022721, 359.9999999995831, 89.99999999958312, dxfattribs={ "layer": "BAO" })
    layout.add_line((-118.227053, -511.775359), (-118.227053, -511.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-133.187024, -511.775359), 14.95997051999438, 269.9999999995831, 359.9999999995831, dxfattribs={ "layer": "BAO" })
    layout.add_line((-133.187024, -526.735329), (-157.666975, -526.735329), dxfattribs={ "layer": "BAO" })
    layout.add_line((-606.208515, 36.29553), (-585.172969, 36.29553), dxfattribs={ "layer": "tex" })
    layout.add_line((-585.172969, 36.29553), (-585.172969, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((-585.172969, 27.022821), (-606.208515, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((-606.208515, 27.022821), (-606.208515, 36.29553), dxfattribs={ "layer": "tex" })
    layout.add_line((-606.208515, 27.022821), (-585.33023, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((-585.33023, 27.022821), (-585.33023, 16.20466), dxfattribs={ "layer": "tex" })
    layout.add_line((-585.33023, 16.20466), (-606.208515, 16.20466), dxfattribs={ "layer": "tex" })
    layout.add_line((-606.208515, 16.20466), (-606.208515, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((614.827031, 36.29553), (593.791485, 36.29553), dxfattribs={ "layer": "tex" })
    layout.add_line((593.791485, 36.29553), (593.791485, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((593.791485, 27.022821), (614.827031, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((614.827031, 27.022821), (614.827031, 36.29553), dxfattribs={ "layer": "tex" })
    layout.add_line((614.827031, 27.022821), (593.948746, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_line((593.948746, 27.022821), (593.948746, 16.20466), dxfattribs={ "layer": "tex" })
    layout.add_line((593.948746, 16.20466), (614.827031, 16.20466), dxfattribs={ "layer": "tex" })
    layout.add_line((614.827031, 16.20466), (614.827031, 27.022821), dxfattribs={ "layer": "tex" })
    layout.add_arc((166.285492, -511.775359), 14.95997051993618, 269.9999999997916, 359.9999999997915, dxfattribs={ "layer": "BAO" })
    layout.add_line((181.245462, -511.775359), (181.245462, -511.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((166.285492, -511.775359), 14.95997052016901, 359.9999999993747, 89.99999999937468, dxfattribs={ "layer": "BAO" })
    layout.add_line((166.285492, -496.815388), (141.80554, -496.815388), dxfattribs={ "layer": "BAO" })
    layout.add_arc((141.80554, -511.775359), 14.95997052022721, 90.00000000041688, 180.0000000004169, dxfattribs={ "layer": "BAO" })
    layout.add_line((126.845569, -511.775359), (126.845569, -511.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((141.80554, -511.775359), 14.95997051999438, 180.0000000004169, 270.0000000004169, dxfattribs={ "layer": "BAO" })
    layout.add_line((141.80554, -526.735329), (166.285492, -526.735329), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-157.666975, -11.775359), 14.95997051999438, 180.0000000004169, 270.0000000004169, dxfattribs={ "layer": "BAO" })
    layout.add_line((-172.626946, -11.775359), (-172.626946, -11.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-157.666975, -11.775359), 14.95997052022721, 90.00000000041688, 180.0000000004169, dxfattribs={ "layer": "BAO" })
    layout.add_line((-157.666975, 3.184612), (-133.187024, 3.184612), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-133.187024, -11.775359), 14.95997052022721, 359.9999999995831, 89.99999999958312, dxfattribs={ "layer": "BAO" })
    layout.add_line((-118.227053, -11.775359), (-118.227053, -11.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((-133.187024, -11.775359), 14.95997051999438, 269.9999999995831, 359.9999999995831, dxfattribs={ "layer": "BAO" })
    layout.add_line((-133.187024, -26.735329), (-157.666975, -26.735329), dxfattribs={ "layer": "BAO" })
    layout.add_arc((166.285492, -11.775359), 14.95997051999438, 269.9999999995831, 359.9999999995831, dxfattribs={ "layer": "BAO" })
    layout.add_line((181.245462, -11.775359), (181.245462, -11.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((166.285492, -11.775359), 14.95997052022721, 359.9999999995831, 89.99999999958312, dxfattribs={ "layer": "BAO" })
    layout.add_line((166.285492, 3.184612), (141.80554, 3.184612), dxfattribs={ "layer": "BAO" })
    layout.add_arc((141.80554, -11.775359), 14.95997052022721, 90.00000000041688, 180.0000000004169, dxfattribs={ "layer": "BAO" })
    layout.add_line((126.845569, -11.775359), (126.845569, -11.775359), dxfattribs={ "layer": "BAO" })
    layout.add_arc((141.80554, -11.775359), 14.95997051999438, 180.0000000004169, 270.0000000004169, dxfattribs={ "layer": "BAO" })
    layout.add_line((141.80554, -26.735329), (166.285492, -26.735329), dxfattribs={ "layer": "BAO" })
    layout.add_line((-1177.310159, 66.524561), (-1177.310159, 12.124668), dxfattribs={ "layer": "Tim", "color": 8 })
    layout.add_lwpolyline([(-1189.550135, 32.524628), (-1165.070183, 32.524628)], dxfattribs={ "layer": "tex" }, close=False)
    layout.add_lwpolyline([(-1189.550135, 46.124601), (-1165.070183, 46.124601)], dxfattribs={ "layer": "tex" }, close=False)
    layout.add_lwpolyline([(-1143.310226, 39.324615), (-1211.310092, 39.324615), (-1211.310092, 52.924588), (-1143.310226, 52.924588)], dxfattribs={ "layer": "B" }, close=True)
    layout.add_lwpolyline([(-1122.910266, 25.724641), (-1231.710052, 25.724641), (-1231.710052, 39.324615), (-1122.910266, 39.324615)], dxfattribs={ "layer": "B" }, close=True)
    layout.add_line((4.689975, 66.524561), (4.689975, 12.124668), dxfattribs={ "layer": "Tim", "color": 8 })
    layout.add_lwpolyline([(-7.550001, 32.524628), (16.929951, 32.524628)], dxfattribs={ "layer": "tex" }, close=False)
    layout.add_lwpolyline([(-7.550001, 46.124601), (16.929951, 46.124601)], dxfattribs={ "layer": "tex" }, close=False)
    layout.add_lwpolyline([(38.689908, 39.324615), (-29.309958, 39.324615), (-29.309958, 52.924588), (38.689908, 52.924588)], dxfattribs={ "layer": "B" }, close=True)
    layout.add_lwpolyline([(59.089868, 25.724641), (-49.709918, 25.724641), (-49.709918, 39.324615), (59.089868, 39.324615)], dxfattribs={ "layer": "B" }, close=True)
    layout.add_line((1186.690109, 66.524561), (1186.690109, 12.124668), dxfattribs={ "layer": "Tim", "color": 8 })
    layout.add_lwpolyline([(1174.450133, 32.524628), (1198.930085, 32.524628)], dxfattribs={ "layer": "tex" }, close=False)
    layout.add_lwpolyline([(1174.450133, 46.124601), (1198.930085, 46.124601)], dxfattribs={ "layer": "tex" }, close=False)
    layout.add_lwpolyline([(1220.690042, 39.324615), (1152.690176, 39.324615), (1152.690176, 52.924588), (1220.690042, 52.924588)], dxfattribs={ "layer": "B" }, close=True)
    layout.add_lwpolyline([(1241.090002, 25.724641), (1132.290216, 25.724641), (1132.290216, 39.324615), (1241.090002, 39.324615)], dxfattribs={ "layer": "B" }, close=True)

def add_to_drawing(msp):
    _doc = _get_doc(msp)
    if _doc is not None:
        _ensure_layers(_doc)
    _draw_into(msp)

def register_block(doc):
    _ensure_layers(doc)
    if BLOCK_NAME in doc.blocks:
        blk = doc.blocks.get(BLOCK_NAME)
    else:
        blk = doc.blocks.new(name=BLOCK_NAME)
    _draw_into(blk)

def insert_block(msp, insert=(0, 0), rotation_deg=0, scale=1.0, layer='0'):
    doc = _get_doc(msp)
    if doc is None:
        raise RuntimeError('Không lấy được document từ layout.')
    if BLOCK_NAME not in doc.blocks:
        register_block(doc)
    ref = msp.add_blockref(BLOCK_NAME, insert, dxfattribs={'layer': layer})
    try:
        ref.dxf.rotation = rotation_deg
        ref.dxf.xscale = scale
        ref.dxf.yscale = scale
    except Exception:
        pass
